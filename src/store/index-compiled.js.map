{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["import Vue from 'vue'\nimport Vuex from \"vuex\"\nimport connect from \"@/libs/connect\"\nimport templates from \"@/templates\"\n\n/**\n * Основные переменные состояния\n * =============================\n * Здесь содержится инструментарий для работы с двумя главными элементами приложения\n * - упражнениями\n * - статистикой\n * Здесь содержатся данные, методы загрузки, сохранения и изменения\n */\n\nVue.use(Vuex);\n// noinspection JSUnusedGlobalSymbols\nexport default new Vuex.Store({\n  state:{\n    test:true,     // Данные для проверки\n    exercises:[],  // Список задангий\n    statistic:[],  // Статистика\n    loaded:false,  // Была ли выполнена загрузка\n    loadedStat:false,\n    uid:0          // Идентификатор пользователя 0 - локальный\n  },\n\n\n  mutations:{\n    /**\n     * Мутация добавления нового упражнения.\n     * TODO Возможно потребуются вспомогательные операции\n     * @param state\n     * @param payload\n     */\n    addExercise(state,payload){\n      state.exercises.push(payload)\n    },\n\n    /**\n     * Внесение изменения в существующее упражнение\n     * @param state\n     * @param payload\n     */\n    updateExercise(state, payload){\n      state.exercises[payload.index] = payload.settings\n    },\n\n    /**\n     * Удаление упражнения\n     * @param state\n     * @param id\n     */\n    delExercise(state,id){\n      state.exercises = state.exercises.filter(el=>el._id !== id)\n    },\n\n    delAllExercises(state){\n      state.exercises = [];\n    },\n\n    /**\n     * Добавление новой записи статистики\n     * @param state\n     * @param payload\n     */\n    pushStatistic(state,payload){\n      state.statistic.push(payload)\n    },\n\n    delStatistic(state){\n      state.statistic = []\n    },\n\n    /**\n     * Указание, что данные загружены и сервера\n     * @param state\n     */\n    dataLoaded(state){\n      state.loaded = true\n    },\n    statLoaded(state){\n      state.loadedStat = true\n    }\n  },\n\n\n  actions:{\n    /**\n     * Упражнения\n     * ----------\n     */\n    /**\n     * Загрузка с сервера упражнений по набору условий\n     * @param context\n     * @param params\n     */\n    async loadExercises({commit,dispatch,state}, params) {\n      if(state.loaded)return false;\n      let data = await connect.loadExercises(params);\n      console.log(data);\n\n      for(let el in data){\n        if(!data.hasOwnProperty(el))\n          continue;\n        commit(\"addExercise\", data[el]);\n      }\n\n      commit(\"dataLoaded\");\n      return true;\n    },\n\n    /**\n     * Сохранение нового упражнения на сервер и внесение его локально\n     * @param commit\n     * @param component\n     */\n    async saveNewExercise({commit},component){\n      let el = {};\n\n      // Клонирование объекта, хоть не красиво -\n      // единственный способ получить рабочую схему\n      for(let name in templates[component]) {\n        el[name] = templates[component][name]\n      }\n\n      let id = await connect.saveExercise(el);\n      if(id || id === 0) {\n        el._id = id;\n        commit(\"addExercise\", el);\n        return id;\n      }\n      else return false;\n    },\n\n    /**\n     * Обновление существующего упражнения\n     * @param commit\n     * @param state\n     * @param settings\n     */\n    updateExercise({commit,state},settings){\n      for(let i = 0;i < state.exercises.length;i ++){\n        if(state.exercises[i]._id === settings._id){\n          if(connect.updateExercises(settings._id,settings))\n            commit(\"updateExercise\",{settings:settings, index:i})\n          else {\n            //TODO Обработка ошибки сохранения\n          }\n        }\n      }\n\n    },\n\n    /**\n     * Удаление упражнения по его _id\n     * @param commit\n     * @param state\n     * @param id\n     */\n    async deleteExercise({commit,state},id){\n      let acc = await connect.deleteExercises(id,state);\n      if(acc) {\n        commit(\"delExercise\", id);\n        return true\n      }\n      else return false;\n    },\n\n    async delAllExercises({commit}){\n      let acc = await connect.deleteAllExercises();\n      if(acc) {\n        commit(\"delAllExercises\");\n        return true;\n      }\n      else return false;\n    },\n\n    /**\n     * Статистика\n     * ----------\n     */\n\n    /**\n     * Загрузка статистики по условиям\n     * @param commit\n     * @param state\n     * @param params\n     */\n    async loadStatistic({commit, state},params){\n      if(state.loadedStat)return false;\n      let statistic = await connect.loadStatistic(params);\n      statistic.forEach(el=>{\n        commit(\"pushStatistic\",el);\n      });\n      commit(\"statLoaded\")\n    },\n\n    /**\n     * Добавление новой записи статистики\n     * @param commit\n     * @param state\n     * @param stat\n     */\n    pushStatistic({commit,state},stat){\n      stat.time = Date.now();\n      stat.uid = state.uid;\n      commit(\"pushStatistic\",stat);\n      connect.pushStatistic(stat,state.statistic);\n    },\n    delStatistic({commit}){\n      connect.delStatistic();\n      commit(\"delStatistic\");\n    }\n  }\n})\n"]}