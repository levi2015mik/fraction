{"version":3,"sources":["lsgroups.js"],"names":[],"mappings":"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","file":"lsgroups-compiled.js","sourcesContent":["/**\n * Методы работы с группами из localStorage вида name_index\n * Может быть применен лишь единожды в программе, так как вся коллекция,\n * независимо от имен, будет лежать в общей шине lsGroups.collection\n * TODO переделать в класс для применения нескольких в одной программе\n */\n\nlet lsGroups = {};\n\nlsGroups.collection = [];\n\n/**\n * Реализует чтение данных.\n * Возвращает массив значений\n * @param name\n * @returns {*} lsGroups.collection | err\n */\nlsGroups.read = function(name) {\n  try {\n    let i = 0;\n    for(let count in localStorage) {\n      if(!localStorage.hasOwnProperty(count)) {\n        continue;\n      }\n      let arr;\n      arr = count.split(\"_\");\n      if(arr.length === 1){\n        continue;\n      }\n      if(arr[0] === name) {\n        lsGroups.collection[i] = loadFromJson(count);\n        i++;\n      }\n    }\n    return lsGroups.collection;\n  } catch(err) {\n    return err;\n  }\n};\n\n/**\n * Сохраняет value в localStorage с именем вида name_index\n * сохранение происходит под следующим после последнего номером\n * @param name\n * @param {object} value\n * @returns {*} индекс сохраненного элемента или err\n */\nlsGroups.write = function(name,value){\n  lsGroups.read(name);\n  //Внутренняя функция для записи в localStorage всего набора параметров из массива\n  function writeAll(){\n    try {\n      for(let i = 0; i<lsGroups.collection.length; i++){\n        objToStorage(lsGroups.collection[i],name + \"_\" + i);\n      }\n    } catch (err) {\n      return err;\n    }\n  }\n  if(typeof value === \"undefined\") {\n    writeAll();\n    return;\n  }\n  try {\n    let count = lsGroups.collection.length;\n    lsGroups.collection.push(value);\n    objToStorage(value,name + \"_\" + count);\n    return count;\n  } catch(err) {\n    return err;\n  }\n};\n\n/**\n * Обновление определенного элемента списка\n * @param num элемент\n * @param value значение\n */\nlsGroups.update = function(num,value){};\n\n/**\n * Удаление всей группы или одного элемента\n * Для удаления всего списка num = \"*\"\n * @param name\n * @param {number | \"*\"} num номер элемента или \"*\" для удаления всего списка\n * @returns {*}\n */\nlsGroups.del = function(name, num){\n  //Удаление всего массива для удобства выносится в новую функцию\n  function delAll() {\n    let i = 0;\n    for (let count in localStorage) {\n      if (!localStorage.hasOwnProperty(count)) {\n        continue;\n      }\n      let arr = count.split(\"_\");\n      if (arr.length === 1) {\n        continue;\n      }\n      if (arr[0] === name) {\n        delete localStorage[name + \"_\" + i];\n        i++;\n      }\n    }\n  }\n  try {\n    let i = 0;\n    if(num ===\"*\") {\n      delAll();\n      return;\n    }\n    //Удаление одного элемента\n    lsGroups.collection.splice(num,1);\n    delAll();\n    lsGroups.write(name);\n\n  } catch (err) {\n    return err;\n  }\n};\n\nfunction objToStorage(obj,name) {\n  let json = \"\";\n  try {\n    json = JSON.stringify(obj);\n  } catch (err) {\n    alert(\"Невозможно преобразовать объект\");\n    return;\n  }\n  try {\n    localStorage[name] = json;\n  } catch (err) {\n    alert(\"Браузер не поддерживает localStorage сохранение невозможно\");\n    return err;\n  }\n  return json;\n}\n\n//\nfunction loadFromJson(name){\n  try{\n    let data = localStorage[name];\n    let obj;\n    obj = JSON.parse(data);\n    return obj;\n  } catch (err) {\n    return false;\n  }\n}\n\nexport default lsGroups;\n"]}